<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Primary Meta Tags -->
    <title>K-12 School Solutions | Greenheck</title>
    <meta name="title" content="K-12 School Solutions | Greenheck" />
    <meta name="description" content="Comprehensive HVAC solutions for K-12 schools including ventilation, energy recovery, and air quality systems designed for educational facilities." />
    <meta name="keywords" content="K-12 school HVAC, school ventilation, educational facility HVAC, school air quality, energy efficient schools" />
    <meta name="author" content="Greenheck Fan Corporation" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.greenheck.com/k-12-school.html" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.greenheck.com/k-12-school.html" />
    <meta property="og:title" content="K-12 School Solutions | Greenheck" />
    <meta property="og:description" content="Comprehensive HVAC solutions for K-12 schools including ventilation, energy recovery, and air quality systems designed for educational facilities." />
    <meta property="og:image" content="https://www.greenheck.com/Content/imgs/school/k-12-hero-bg.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="K-12 school HVAC solutions" />
    <meta property="og:site_name" content="Greenheck" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://www.greenheck.com/k-12-school.html" />
    <meta name="twitter:title" content="K-12 School Solutions | Greenheck" />
    <meta name="twitter:description" content="Comprehensive HVAC solutions for K-12 schools including ventilation, energy recovery, and air quality systems designed for educational facilities." />
    <meta name="twitter:image" content="https://www.greenheck.com/Content/imgs/school/k-12-hero-bg.png" />
    <meta name="twitter:image:alt" content="K-12 school HVAC solutions" />

    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#075697" />
    <meta name="msapplication-TileColor" content="#075697" />
    <meta name="application-name" content="Greenheck" />
    <meta name="apple-mobile-web-app-title" content="Greenheck" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://www.google-analytics.com" />

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//www.google-analytics.com" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./Content/imgs/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="./Content/imgs/favicon-32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./Content/imgs/favicon-16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="./Content/imgs/favicon-180.png" />
    <link rel="manifest" href="./site.webmanifest" />

    <!-- Material Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&URL_ADDRESS" />

    <!-- External CSS -->
    <link rel="stylesheet" href="./Content/css/common.css" />
    <link rel="stylesheet" href="./Content/css/header.css" />
    <link rel="stylesheet" href="./Content/css/product.css" />
    <link rel="stylesheet" href="./Content/css/footer.css" />
    <link rel="stylesheet" href="./Content/css/k-12-school.css" />

    <!-- Schema.org JSON-LD Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@graph": [
          {
            "@type": "Organization",
            "@id": "https://www.greenheck.com/#organization",
            "name": "Greenheck Fan Corporation",
            "url": "https://www.greenheck.com",
            "logo": {
              "@type": "ImageObject",
              "url": "https://www.greenheck.com/Content/imgs/Greenheck_Logo_Horizontal_Blue.png",
              "width": 200,
              "height": 60
            },
            "sameAs": [
              "https://www.linkedin.com/company/greenheck",
              "https://www.facebook.com/GreenheckFan",
              "https://www.youtube.com/user/GreenheckFan"
            ],
            "contactPoint": {
              "@type": "ContactPoint",
              "telephone": "+1-715-359-6171",
              "contactType": "customer service",
              "availableLanguage": "English"
            },
            "address": {
              "@type": "PostalAddress",
              "addressCountry": "US",
              "addressLocality": "Schofield",
              "addressRegion": "WI",
              "postalCode": "54476",
              "streetAddress": "P.O. Box 410"
            }
          },
          {
            "@type": "WebSite",
            "@id": "https://www.greenheck.com/#website",
            "url": "https://www.greenheck.com",
            "name": "Greenheck - Building Value in Air",
            "description": "Greenheck Fan Corporation provides comprehensive HVAC solutions including fans, dampers, louvers, energy recovery systems, and air terminal units for commercial and industrial applications.",
            "publisher": {
              "@id": "https://www.greenheck.com/#organization"
            },
            "potentialAction": {
              "@type": "SearchAction",
              "target": "https://www.greenheck.com/search?q={search_term_string}",
              "query-input": "required name=search_term_string"
            }
          },
          {
            "@type": "BreadcrumbList",
            "@id": "https://www.greenheck.com/#breadcrumb",
            "itemListElement": [
              {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://www.greenheck.com"
              },
              {
                "@type": "ListItem",
                "position": 2,
                "name": "Building Type",
                "item": "https://www.greenheck.com/building-type"
              },
              {
                "@type": "ListItem",
                "position": 3,
                "name": "K-12 School",
                "item": "https://www.greenheck.com/k-12-school.html"
              }
            ]
          },
          {
            "@type": "Service",
            "@id": "https://www.greenheck.com/#k12-school-solutions",
            "name": "K-12 School HVAC Solutions",
            "description": "Comprehensive HVAC solutions for K-12 schools including ventilation, energy recovery, and air quality systems designed for educational facilities.",
            "provider": {
              "@id": "https://www.greenheck.com/#organization"
            },
            "areaServed": {
              "@type": "Country",
              "name": "United States"
            },
            "serviceType": "HVAC Systems for Educational Facilities"
          }
        ]
      }
    </script>
</head>

<body>
    <!-- Header include -->
    <div data-include="./Content/includes/header.html"></div>
    <!-- Anchor for scroll to top -->
    <div id="top"></div>

    <!-- Main Content -->
    <main id="main-content" role="main">
        <!-- Breadcrumb Navigation -->
        <nav class="breadcrumb" aria-label="Breadcrumb navigation">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/" class="breadcrumb-link">Home</a>
                </li>
                <li class="breadcrumb-item">
                    <span class="material-symbols-outlined breadcrumb-arrow">chevron_right</span>
                </li>
                <li class="breadcrumb-item">
                    <span class="breadcrumb-current" aria-current="page">K-12 School</span>
                </li>
            </ol>
        </nav>

        <h1 class="page-title">K-12 School</h1>
        <section class="hero-section">
            <img src="./Content/imgs/k-12-hero-bg.png" alt="Building exterior view of Greenheck High School" class="hero-background" />
            <div class="hero-overlay">
                <div class="hero-content">
                    <h2 class="hero-title">SHARE</h2>
                    <p class="hero-description">
                        THIS INFORMATIVE, USEFUL<br>
                        & ENGAGING EXPERIENCE
                    </p>
                    <div class="hero-buttons">
                        <button class="hero-btn hero-btn-primary" id="select-space-btn">
                            <img src="./Content/imgs/icons/select-a-space.svg" alt="Select a Space" />
                            Select a Space
                        </button>
                        <button class="hero-btn">
                            <img src="./Content/imgs/icons/share.svg" alt="Share" />
                            Share
                        </button>
                    </div>
                </div>
            </div>
        </section>
        <h2 class="section-title">Healthier Indoor Air is the Answer</h2>
        <p class="section-description">
            Greenheck offers a complete line of ventilation products for educational facilities that create a safe, comfortable, and productive environment for students and staff while keeping operating and installation
            costs low.
        </p>
        <p class="section-description">
            Our products are designed to work together as complete, integrated systems that incorporate ventilation, filtration, humidification, and air circulation for healthier indoor spaces and improved learning.
        </p>
        <!-- Space Selection Modal -->
        <div id="space-selection-modal" class="space-selection-modal-overlay w-full p-0 m-0" style="display: none;">
            <div class="space-selection-modal-container">
                <!-- Modal Header -->
                <div class="space-selection-modal-header">
                    <div class="space-selection-modal-header-left">
                        <button class="space-selection-modal-back-btn" id="modal-back-btn" style="display: none;">
                            <span class="material-symbols-outlined">keyboard_arrow_down</span>
                        </button>
                        <div class="space-selection-modal-title" id="modal-title">
                            <div class="space-selection-modal-space-name"></div>
                            <div class="space-selection-modal-system-name" id="modal-system-name" style="display: none;">Dedicated Outdoor Air System (DOAS)</div>
                        </div>
                    </div>
                    <div class="space-selection-modal-tabs" id="modal-tabs">
                        <button class="space-selection-modal-tab" data-tab="overview">Overview</button>
                        <button class="space-selection-modal-tab" data-tab="system-equipment">System Equipment</button>
                        <button class="space-selection-modal-tab" data-tab="design-narrative">Design Narrative</button>
                        <button class="space-selection-modal-share-btn">
                            <img src="./Content/imgs/icons/share-modal.svg" alt="Share" />
                            Share
                        </button>
                    </div>
                </div>

                <!-- Modal Content -->
                <div class="space-selection-modal-content">
                    <button class="space-selection-modal-close-btn" id="modal-close-btn">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                    <!-- Building Overview Scene -->
                    <div id="building-overview-scene" class="scene active">
                        <div class="school-building-container">
                            <div class="school-building">
                                <img src="./Content/imgs/school/school-roof-on.svg" alt="Greenheck High School Building" class="school-building-image" />
                                <img src="./Content/imgs/school/school-roof-off.webp" alt="Admin Office Roof Open" class="school-building-image admin-office-overlay" style="display: none;" />
                                <!-- Clickable Areas -->
                                <div class="clickable-area classrooms" data-space="classrooms" data-system="Dedicated Outdoor Air System(DOAS)" style="top: 43.8%; left: 18.5%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Classrooms</div>
                                </div>

                                <div class="clickable-area science-lab" data-space="science-lab" data-system="DOAS" style="top: 19.6%; left: 33.8%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Science Lab</div>
                                </div>

                                <div class="clickable-area locker-room" data-space="locker-room" data-system="DOAS" style="top: 24%;left: 39.4%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Locker Room</div>
                                </div>

                                <div class="clickable-area admin-offices" data-space="admin-offices" data-system="Multi-zone variable air volume" style="top: 43.5%; left: 50.1%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Admin Offices</div>
                                </div>

                                <div class="clickable-area gym" data-space="gym" data-system="DOAS" style="top: 12.5%; left: 53.0%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Gym</div>
                                </div>

                                <div class="clickable-area lobby" data-space="lobby" data-system="DOAS" style="top: 26%; left: 62.5%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Lobby</div>
                                </div>

                                <div class="clickable-area cafeteria" data-space="cafeteria" data-system="DOAS" style="top: 26%; left: 76.4%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Cafeteria</div>
                                </div>

                                <div class="clickable-area kitchen" data-space="kitchen" data-system="DOAS" style="top: 23.1%; left: 86.5%; right: auto; transform: none;">
                                    <div class="space-icon"></div>
                                    <div class="space-label">Kitchen</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Popover -->
                    <div id="space-popover" class="space-popover" style="display: none;">
                        <div class="popover-content">
                            <div class="popover-header">

                                <button class="popover-close-btn" id="popover-close-btn">
                                    <span class="material-symbols-outlined">close</span>
                                </button>
                            </div>
                            <div class="popover-body">
                                <h3 id="popover-space-name">Classroom</h3>
                                <p id="popover-system-name">Dedicated Outdoor Air System (DOAS)</p>
                                <button class="popover-view-btn" id="popover-view-btn">View</button>
                            </div>
                        </div>
                    </div>

                    <!-- Detail Scene -->
                    <div id="detail-scene" class="scene">
                        <div class="detail-content">
                            <!-- Left Panel - Text Content -->
                            <div class="detail-left-panel">
                                <div class="detail-text-content">
                                    <!-- Overview Tab Content -->
                                    <div id="overview-content" class="tab-content active">
                                        <h3 id="detail-title">Classroom Overview</h3>
                                        <p id="detail-description">
                                            The flexible design decouples ventilation air and loads, allowing the DOAS units to handle latent loads and condition air while secondary HVAC systems handle sensible loads.
                                            This
                                            approach provides better control, energy efficiency, and comfort. Proper control is essential for maintaining comfort and extending equipment lifespan.
                                        </p>
                                        <h4>Featured Equipment</h4>
                                        <ul>
                                            <li>Dedicated Outdoor Air System (DOAS) with energy recovery</li>
                                            <li>Secondary HVAC system (not provided by Greenheck)</li>
                                        </ul>
                                    </div>

                                    <!-- System Equipment Tab Content -->
                                    <div id="system-equipment-content" class="tab-content">
                                        <div class="product-carousel">
                                            <div class="product-card active" data-product="rve-85">
                                                <h3>RVE-85</h3>
                                                <div class="product-image-container">
                                                    <button class="carousel-prev">‹</button>
                                                    <div class="product-image">
                                                        <div class="hvac-unit-3d">HVAC Unit 3D</div>
                                                    </div>
                                                    <button class="carousel-next">›</button>
                                                </div>
                                                <div class="carousel-dots">
                                                    <span class="dot active"></span>
                                                    <span class="dot"></span>
                                                    <span class="dot"></span>
                                                    <span class="dot"></span>
                                                </div>
                                                <ul class="product-features">
                                                    <li>Direct drive plenum supply and optional exhaust fans with neoprene isolation and factory-provided variable frequency drive.</li>
                                                    <li>2-inch double-wall cabinet with R13 injected foam insulation. R13 foam insulation thermally broken. Exterior Finish Permatector™ (2,500 hr salt spray rating under
                                                        ASTM
                                                        B117 testing conditions)</li>
                                                </ul>
                                                <button class="view-product-details-btn">View Product Details</button>
                                            </div>

                                            <div class="product-card" data-product="atu-xg-th-500">
                                                <h3>ATU - XG-TH-500</h3>
                                                <div class="product-image-container">
                                                    <button class="carousel-prev">‹</button>
                                                    <div class="product-image">
                                                        <div class="hvac-unit-3d">VAV Box 3D</div>
                                                    </div>
                                                    <button class="carousel-next">›</button>
                                                </div>
                                                <div class="carousel-dots">
                                                    <span class="dot active"></span>
                                                    <span class="dot"></span>
                                                    <span class="dot"></span>
                                                </div>
                                                <ul class="product-features">
                                                    <li>Damper rotates in a self-lubricating, long-life, low-friction thermoplastic bearing</li>
                                                    <li>Industry leading continuous welded primary inlet duct to minimize leakage with three stiffening beads for added rigidity</li>
                                                    <li>Mechanically fastened damper assembly shall be double layer, 18-gauge equivalent, galvanized</li>
                                                </ul>
                                                <button class="view-product-details-btn">View Product Details</button>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Design Narrative Tab Content -->
                                    <div id="design-narrative-content" class="tab-content">
                                        <h3>Classroom Design Narrative</h3>
                                        <p>
                                            The <strong>Dedicated Outdoor Air System (DOAS)</strong> model handles latent loads and conditions air while secondary HVAC systems handle sensible loads. The design centers on
                                            a
                                            <strong>Greenheck model RVE-85, rooftop ventilator</strong> equipped with a <strong>polymer total energy recovery wheel</strong> and a <strong>packaged Air Source Heat Pump
                                                (ASHP)</strong> with electric secondary heating.
                                        </p>
                                        <p>
                                            The unit includes <strong>modulating, inverter scroll compressors</strong>, <strong>electronically commutated (EC) on all condenser fan motors</strong>, and <strong>modulating
                                                hot
                                                gas reheat</strong>. Supply and exhaust fans are controlled by <strong>factory provided, field mounted duct static pressure sensors</strong>.
                                        </p>
                                        <p>
                                            Each room features <strong>motorized, single duct VAV boxes, Greenheck model XG-TH-500</strong>, which open/close based on occupancy to maintain ventilation. Air terminal units
                                            have <strong>1" fiberglass insulation with 1 1/2 lb weight</strong> and connect to a <strong>Greenheck XG-5750 air diffuser</strong>.
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Panel - 3D Exploded View -->
                            <div class="detail-right-panel">
                                <div class="exploded-view-container">
                                    <div class="exploded-3d-view">
                                        <div class="hvac-elements">
                                            <div class="hvac-component blue-highlight" data-product="rve-85">RVE-85</div>
                                            <div class="hvac-component blue-highlight" data-product="atu-xg-th-500">VAV Box</div>
                                            <div class="hvac-component">Ductwork</div>
                                            <div class="hvac-component">Diffuser</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scroll to Top Button -->
    <a href="#top" class="scroll-to-top" aria-label="Scroll to top">
        <span class="material-symbols-outlined scroll-to-top">arrow_circle_up</span>
    </a>

    <!-- Footer include -->
    <div data-include="./Content/includes/footer.html"></div>

    <!-- Performance and Analytics Scripts -->
    <script>
        // Performance optimization: Lazy load images
        document.addEventListener("DOMContentLoaded", function () {
            // Add loading="lazy" to images when they're added
            const images = document.querySelectorAll("img");
            images.forEach((img) => {
                img.setAttribute("loading", "lazy");
            });

            // Smooth scrolling for anchor links
            const anchorLinks = document.querySelectorAll('a[href^="#"]');
            anchorLinks.forEach((link) => {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute("href"));
                    if (target) {
                        target.scrollIntoView({
                            behavior: "smooth",
                            block: "start",
                        });
                    }
                });
            });
        });

        // Service Worker registration for PWA capabilities
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", function () {
                navigator.serviceWorker
                    .register("/sw.js")
                    .then(function (registration) {
                        console.log("ServiceWorker registration successful");
                    })
                    .catch(function (err) {
                        console.log("ServiceWorker registration failed");
                    });
            });
        }
    </script>
    <!-- Include utility must load before header.js to ensure includes are loaded first -->
    <script src="./Content/js/includes.js"></script>
    <script src="./Content/js/header.js"></script>
    <script>
        // Accordion functionality for mobile/tablet
        (function () {
            const mq = window.matchMedia('(max-width: 1023px)');
            const accordionBtns = Array.from(document.querySelectorAll('.footer-accordion-btn'));
            const panels = Array.from(document.querySelectorAll('.footer-accordion-panel'));

            function closeAll() {
                accordionBtns.forEach(btn => {
                    btn.setAttribute('aria-expanded', 'false');
                    btn.querySelector('.icon').textContent = '+';
                });
                panels.forEach(panel => {
                    panel.setAttribute('aria-hidden', 'true');
                });
            }

            function openPanel(idx) {
                accordionBtns[idx].setAttribute('aria-expanded', 'true');
                accordionBtns[idx].querySelector('.icon').textContent = '−';
                panels[idx].setAttribute('aria-hidden', 'false');
            }

            function handleAccordionClick(e) {
                const idx = accordionBtns.indexOf(e.currentTarget);
                const expanded = e.currentTarget.getAttribute('aria-expanded') === 'true';
                closeAll();
                if (!expanded) {
                    openPanel(idx);
                }
            }

            function handleAccordionKeydown(e) {
                const idx = accordionBtns.indexOf(e.currentTarget);
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    accordionBtns[(idx + 1) % accordionBtns.length].focus();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    accordionBtns[(idx - 1 + accordionBtns.length) % accordionBtns.length].focus();
                } else if (e.key === 'Home') {
                    e.preventDefault();
                    accordionBtns[0].focus();
                } else if (e.key === 'End') {
                    e.preventDefault();
                    accordionBtns[accordionBtns.length - 1].focus();
                } else if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    handleAccordionClick.call(e.currentTarget, e);
                }
            }

            function updateAccordionDisplay() {
                if (mq.matches) {
                    // Show accordion, hide headings
                    accordionBtns.forEach(btn => (btn.style.display = 'block'));
                    document.querySelectorAll('.footer-heading').forEach(h => (h.style.display = 'none'));
                } else {
                    // Hide accordion, show headings
                    accordionBtns.forEach(btn => (btn.style.display = 'none'));
                    panels.forEach(panel => {
                        panel.setAttribute('aria-hidden', 'false');
                    });
                    document.querySelectorAll('.footer-heading').forEach(h => (h.style.display = 'block'));
                }
            }

            accordionBtns.forEach((btn, idx) => {
                btn.addEventListener('click', handleAccordionClick);
                btn.addEventListener('keydown', handleAccordionKeydown);
            });

            // On load, open the first section on mobile/tablet
            function initAccordion() {
                closeAll();
                if (!mq.matches) {
                    panels.forEach(panel => panel.setAttribute('aria-hidden', 'false'));
                }
                updateAccordionDisplay();
            }

            mq.addEventListener('change', initAccordion);
            window.addEventListener('DOMContentLoaded', initAccordion);
            window.addEventListener('resize', updateAccordionDisplay);
        })();
    </script>
    <!-- Space Selection Modal Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Constants
            const POPOVER_OFFSET_X = 19;
            const POPOVER_OFFSET_Y = 235;

            // Helper functions
            function capitalizeSpace(space) {
                return space.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            }

            // Cached DOM Elements - Main
            const selectSpaceBtn = document.getElementById('select-space-btn');
            const modal = document.getElementById('space-selection-modal');
            const closeBtn = document.getElementById('modal-close-btn');
            const backBtn = document.getElementById('modal-back-btn');
            const modalOverlay = document.querySelector('.space-selection-modal-overlay');
            const modalTabs = document.getElementById('modal-tabs');

            // Cached DOM Elements - Scenes
            const buildingOverviewScene = document.getElementById('building-overview-scene');
            const detailScene = document.getElementById('detail-scene');
            const popover = document.getElementById('space-popover');
            const adminOfficeOverlay = document.querySelector('.admin-office-overlay');

            // Cached NodeLists
            const tabs = document.querySelectorAll('.space-selection-modal-tab');
            const shareBtn = document.querySelector('.space-selection-modal-share-btn');
            const clickableAreas = document.querySelectorAll('.clickable-area');
            const tabContents = document.querySelectorAll('.tab-content');
            const productCards = document.querySelectorAll('.product-card');
            const dots = document.querySelectorAll('.dot');
            const hvacComponents = document.querySelectorAll('.hvac-component');

            // Popover elements
            const popoverCloseBtn = document.getElementById('popover-close-btn');
            const popoverViewBtn = document.getElementById('popover-view-btn');
            const popoverSpaceName = document.getElementById('popover-space-name');
            const popoverSystemName = document.getElementById('popover-system-name');

            // Detail scene elements
            const modalSpaceName = document.querySelector('.space-selection-modal-space-name');
            const modalSystemName = document.getElementById('modal-system-name');
            const detailTitle = document.getElementById('detail-title');
            const detailDescription = document.getElementById('detail-description');

            // State
            let currentSpace = null;
            let currentSystem = null;
            let currentProductIndex = 0;
            let isPopoverVisible = false;
            let focusableElements = [];
            let firstFocusableElement = null;
            let lastFocusableElement = null;
            let previousClickedMarker = null;

            // Focus trap helper
            function updateFocusableElements() {
                const focusableSelectors = 'button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])';
                focusableElements = Array.from(modal.querySelectorAll(focusableSelectors));
                firstFocusableElement = focusableElements[0];
                lastFocusableElement = focusableElements[focusableElements.length - 1];
            }

            function trapFocus(e) {
                if (e.key !== 'Tab') {
                    return;
                }

                if (e.shiftKey) {
                    if (document.activeElement === firstFocusableElement) {
                        lastFocusableElement.focus();
                        e.preventDefault();
                    }
                } else {
                    if (document.activeElement === lastFocusableElement) {
                        firstFocusableElement.focus();
                        e.preventDefault();
                    }
                }
            }

            // Open modal
            selectSpaceBtn.addEventListener('click', function () {
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                showBuildingOverview();
                updateFocusableElements();
                setTimeout(() => closeBtn.focus(), 100);
                modal.addEventListener('keydown', trapFocus);
            });

            // Close modal
            function closeModal() {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                hidePopover();
                showBuildingOverview();
                modal.removeEventListener('keydown', trapFocus);
                selectSpaceBtn.focus();
            }

            closeBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', function (e) {
                if (e.target === modalOverlay) {
                    closeModal();
                }
            });

            // Show building overview scene
            function showBuildingOverview() {
                buildingOverviewScene.classList.add('active');
                detailScene.classList.remove('active');
                backBtn.style.display = 'none';
                modalSpaceName.textContent = '';
                modalSystemName.style.display = 'none';
                modalTabs.style.display = 'flex';

                // Disable tab buttons and share button in overview scene
                tabs.forEach(tab => {
                    tab.disabled = true;
                });
                if (shareBtn) {
                    shareBtn.disabled = true;
                }

                // Reset admin office overlay
                if (adminOfficeOverlay) {
                    adminOfficeOverlay.style.display = 'none';
                }

                // Show all clickable areas again
                clickableAreas.forEach(area => {
                    area.style.display = 'flex';
                });

                // Reset marker tracking
                previousClickedMarker = null;

                updateFocusableElements();
            }

            // Show detail scene
            function showDetailScene(space, system) {
                currentSpace = space;
                currentSystem = system;

                buildingOverviewScene.classList.remove('active');
                detailScene.classList.add('active');
                backBtn.style.display = 'flex';
                modalSpaceName.textContent = capitalizeSpace(space);
                modalSystemName.textContent = system;
                modalSystemName.style.display = 'block';
                modalTabs.style.display = 'flex';

                // Ensure Overview tab is selected and its content is shown
                tabs.forEach(tab => {
                    tab.disabled = false;
                    tab.classList.remove('active');
                });
                if (shareBtn) {
                    shareBtn.disabled = false;
                }
                const overviewTab = document.querySelector('[data-tab="overview"]');
                if (overviewTab) {
                    overviewTab.classList.add('active');
                }

                // Show Overview content
                tabContents.forEach(content => content.classList.remove('active'));
                const overviewContent = document.getElementById('overview-content');
                if (overviewContent) {
                    overviewContent.classList.add('active');
                }

                // Update content based on space
                updateDetailContent(space, system);
                updateFocusableElements();
            }

            // Update detail content based on space
            function updateDetailContent(space, system) {
                const spaceData = {
                    'classrooms': {
                        title: 'Classroom Overview',
                        description: 'The flexible design decouples ventilation air and loads, allowing the DOAS units to handle latent loads and condition air while secondary HVAC systems handle sensible loads. This approach provides better control, energy efficiency, and comfort. Proper control is essential for maintaining comfort and extending equipment lifespan.',
                        equipment: [
                            'Dedicated Outdoor Air System (DOAS) with energy recovery',
                            'Secondary HVAC system (not provided by Greenheck)'
                        ]
                    },
                    'gym': {
                        title: 'Gym Overview',
                        description: 'The gymnasium features a single-zone, variable airflow system designed for high occupancy and activity levels. The system includes demand-controlled ventilation and high-volume, low-speed fans for optimal air circulation.',
                        equipment: [
                            'High Volume Low Speed (HVLS) fans',
                            'Demand-controlled ventilation system'
                        ]
                    }
                };

                const data = spaceData[space] || spaceData['classrooms'];
                detailTitle.textContent = data.title;
                detailDescription.textContent = data.description;
            }

            // Show popover
            function showPopover(space, system, x, y) {
                currentSpace = space;
                currentSystem = system;
                isPopoverVisible = true;

                popoverSpaceName.textContent = capitalizeSpace(space);
                popoverSystemName.textContent = system;
                popover.style.display = 'flex';
                popover.style.left = `${x}px`;
                popover.style.top = `${y}px`;
            }

            // Hide popover
            function hidePopover() {
                popover.style.display = 'none';
                isPopoverVisible = false;
            }

            // Clickable areas functionality
            clickableAreas.forEach(area => {
                area.addEventListener('click', function (e) {
                    e.stopPropagation();
                    const space = this.dataset.space;
                    const system = this.dataset.system;

                    // Reset previous marker if exists
                    if (previousClickedMarker && previousClickedMarker !== this) {
                        previousClickedMarker.style.display = 'flex';
                    }

                    // Toggle admin office roof overlay
                    if (space === 'admin-offices' && adminOfficeOverlay) {
                        const isVisible = adminOfficeOverlay.style.display !== 'none';
                        adminOfficeOverlay.style.display = isVisible ? 'none' : 'block';
                    }

                    // Store the position before hiding the area
                    const rect = this.getBoundingClientRect();
                    const modalRect = modal.getBoundingClientRect();
                    const x = rect.left - modalRect.left + rect.width / 2 - POPOVER_OFFSET_X;
                    const y = rect.top - modalRect.top - POPOVER_OFFSET_Y;

                    // Hide the clicked area
                    this.style.display = 'none';

                    // Track this marker as the previous one
                    previousClickedMarker = this;

                    // Show popover at the same position
                    showPopover(space, system, x, y);
                });
            });

            // Popover view button
            popoverViewBtn.addEventListener('click', function () {
                // Enable tab buttons and share button, and select Overview
                tabs.forEach(tab => {
                    tab.disabled = false;
                    tab.classList.remove('active');
                });
                if (shareBtn) {
                    shareBtn.disabled = false;
                }
                // Select Overview tab
                const overviewTab = document.querySelector('[data-tab="overview"]');
                if (overviewTab) {
                    overviewTab.classList.add('active');
                }

                hidePopover();
                showDetailScene(currentSpace, currentSystem);
            });

            // Popover close button
            popoverCloseBtn.addEventListener('click', function () {
                hidePopover();
                // Show all clickable areas when popover is closed
                clickableAreas.forEach(area => {
                    area.style.display = 'flex';
                });
                // Reset marker tracking
                previousClickedMarker = null;
            });

            // Back button
            backBtn.addEventListener('click', function () {
                showBuildingOverview();
            });

            // Tab functionality
            tabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const tabName = this.dataset.tab;

                    // Update tab states
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    // Update tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    const targetContent = document.getElementById(`${tabName}-content`);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });

            // Product carousel functionality
            function showProduct(index) {
                productCards.forEach((card, i) => {
                    card.classList.toggle('active', i === index);
                });
                dots.forEach((dot, i) => {
                    dot.classList.toggle('active', i === index);
                });
            }

            // Event delegation for carousel controls
            document.addEventListener('click', function (e) {
                const prevBtn = e.target.closest('.carousel-prev');
                const nextBtn = e.target.closest('.carousel-next');

                if (prevBtn && modal.style.display === 'flex') {
                    currentProductIndex = currentProductIndex > 0 ? currentProductIndex - 1 : productCards.length - 1;
                    showProduct(currentProductIndex);
                } else if (nextBtn && modal.style.display === 'flex') {
                    currentProductIndex = currentProductIndex < productCards.length - 1 ? currentProductIndex + 1 : 0;
                    showProduct(currentProductIndex);
                }
            });

            // HVAC component clicks
            hvacComponents.forEach(component => {
                component.addEventListener('click', function () {
                    const product = this.dataset.product;
                    if (product) {
                        // Find and show the corresponding product card
                        const productCard = document.querySelector(`[data-product="${product}"]`);
                        if (productCard) {
                            const cardIndex = Array.from(productCards).indexOf(productCard);
                            if (cardIndex !== -1) {
                                currentProductIndex = cardIndex;
                                showProduct(currentProductIndex);
                                // Switch to System Equipment tab
                                tabs.forEach(t => t.classList.remove('active'));
                                const systemEquipmentTab = document.querySelector('[data-tab="system-equipment"]');
                                const systemEquipmentContent = document.getElementById('system-equipment-content');

                                if (systemEquipmentTab) {
                                    systemEquipmentTab.classList.add('active');
                                }

                                tabContents.forEach(content => content.classList.remove('active'));
                                if (systemEquipmentContent) {
                                    systemEquipmentContent.classList.add('active');
                                }
                            }
                        }
                    }
                });
            });

            // Keyboard navigation
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    if (isPopoverVisible) {
                        hidePopover();
                        // Show all clickable areas when popover is closed
                        clickableAreas.forEach(area => {
                            area.style.display = 'flex';
                        });
                        // Reset marker tracking
                        previousClickedMarker = null;
                    } else if (modal.style.display === 'flex') {
                        closeModal();
                    }
                }
            });

            // Click outside popover to close - Only run when popover is visible
            document.addEventListener('click', function (e) {
                if (isPopoverVisible && !popover.contains(e.target) && !e.target.closest('.clickable-area')) {
                    hidePopover();
                    // Show all clickable areas when popover is closed by clicking outside
                    clickableAreas.forEach(area => {
                        area.style.display = 'flex';
                    });
                    // Reset marker tracking
                    previousClickedMarker = null;
                }
            });
        });
    </script>
</body>

</html>